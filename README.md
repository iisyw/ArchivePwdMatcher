# Archive Tools - Go Version

这是一个使用 Go 语言编写的高性能多功能压缩文件处理工具。它集成了**批量密码匹配**和**智能批量解压**两大核心功能，支持 `.zip`, `.rar`, `.7z` 格式。

## 核心优势

*   **高性能**: 底层逻辑由 Go 语言实现，相比脚本语言，拥有更快的执行效率。
*   **多功能集成**: 在一个工具内同时提供密码匹配和批量解压两种实用功能。
*   **智能解压**: 独有的“智能解压”模式能自动分析压缩包结构，避免解压后文件散落一地或产生不必要的嵌套文件夹。
*   **灵活扫描**: 用户可以自由选择是否递归扫描子文件夹，以及是否自动跳过已经解压过的文件，极大提升了处理大量文件时的灵活性。
*   **依赖简化**: 所有核心功能（包括对 `.rar` 文件的处理）都统一由 `7-Zip` 驱动，无需安装额外的 `unrar` 工具。
*   **友好的终端界面**: 采用经典的终端交互界面，提供清晰、实时的进度反馈。

## 支持格式

*   ZIP (`.zip`)
*   RAR (`.rar`)
*   7z (`.7z`)

## 安装与配置

1.  **安装 Go 环境**: 请确保您的系统中已安装 Go 语言环境 (建议版本 >= 1.18)。

2.  **安装 7-Zip**: 本工具的所有功能都依赖 `7-Zip` 命令行工具。
    *   从 [7-Zip 官网](https://www.7-zip.org/) 下载并安装。
    *   **重要**: 请确保 `7z.exe` 所在的路径已添加到系统的 `PATH` 环境变量中，或者将 `7z.exe` 文件直接复制到本项目根目录下。

3.  **获取本项目**:

    ```bash
    git clone [项目仓库地址]
    cd ArchiveTools
    ```

## 使用方法

1.  **准备密码文件**:
    *   在项目根目录下，创建一个名为 `passwords.txt` 的文本文件。
    *   将您所有已知的密码逐行放入该文件中。程序会自动处理空行和重复的密码。

2.  **运行程序**:
    *   在项目根目录下，执行以下命令：

        ```bash
        go run .
        ```

    *   或者，您也可以先构建一个可执行文件，再运行它：

        ```bash
        go build .
        ./ArchiveTools
        ```

### 交互流程

程序启动后，将引导您完成一系列选择：

**第1步：输入目标路径**
程序会首先提示您输入需要处理的压缩包文件或文件夹路径。如果直接按回车，将默认使用当前目录。

```
请输入要处理的压缩包或文件夹路径 (留空使用当前目录): E:\Downloads
```

**第2步：配置扫描选项**
接下来，您可以配置本次任务的扫描方式：

```
════════════════════════ 扫描选项 ════════════════════════
是否递归扫描子文件夹? (y/N): y
是否排除已解压的压缩包? (Y/n):
══════════════════════════════════════════════════════════
```
*   **递归扫描**：输入 `y` 会扫描所有子文件夹，默认为 `N` (否)。
*   **排除已解压**：如果一个压缩包（如 `archive.zip`）旁边已经存在一个同名的文件夹 (`archive`)，则跳过它。默认为 `Y` (是)。

**第3步：选择主功能**
然后，选择您要执行的核心功能：

```
════════════════════════ 主菜单 ════════════════════════
1. 密码匹配器 (批量扫描并使用密码本匹配压缩包密码)
2. 批量解压器 (批量扫描并使用密码本解压压缩包)
════════════════════════════════════════════════════════
请输入功能选项 [1-2]:```

**第4步：功能子选项**

*   **如果选择“密码匹配器”**:
    *   程序会显示任务摘要，并让您选择**匹配模式**（快速/精确），然后开始匹配。
    *   所有成功匹配的结果，都会被记录在项目根目录下的 `result/` 文件夹中。

*   **如果选择“批量解压器”**:
    *   程序会进入解压选项菜单：
        ```
        ════════════════════════ 解压选项 ════════════════════════
        1. 智能解压 (推荐)
        2. 解压到当前目录
        3. 解压到同名文件夹
        ══════════════════════════════════════════════════════════
        请选择解压模式 [默认为1]:
        ```
    *   **智能解压 (默认)**:
        *   如果压缩包内只有一个与压缩包同名的文件夹，则将其内容直接解压到当前目录。
        *   否则，自动创建一个与压缩包同名的文件夹，并将所有内容解压进去。
    *   **解压到当前目录**: 将所有压缩包的内容直接解压到它们各自所在的目录。
    *   **解压到同名文件夹**: 为每个压缩包创建一个同名文件夹进行解压。

## 注意事项

*   **CPU 消耗**: 本程序是一个“计算密集型”工具。在运行过程中，它会显著占用您的 CPU 资源来进行解密运算。
*   **依赖 `7-Zip`**: 本工具的可靠性直接建立在 `7-Zip` 的官方命令行程序之上。请务必确保它已正确安装并配置。
